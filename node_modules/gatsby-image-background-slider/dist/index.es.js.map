{"version":3,"file":"index.es.js","sources":["../src/index.js"],"sourcesContent":["import React, { useEffect } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport Img from \"gatsby-image\"\r\n\r\nconst BackgroundSlider = ({images, duration, transition, initDelay, query, children, ...gatsbyImageProps}) => {\t\r\n\tlet nodes = [];\r\n\tlet bgRefs = [];\r\n\tlet subRefs = [];\t\r\n\tlet bgWrappers = [];\r\n\tlet subWrappers = [];\r\n\tconst {style, ...imageProps} = gatsbyImageProps;\r\n\r\n\tnodes.safePush = function(data){\r\n\t\tif(data){\r\n\t\t\treturn this.push(data);\r\n\t\t}else{\r\n\t\t\treturn this.length;\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(images){\r\n\t\tfor(let image of images){\r\n\t\t\tnodes.safePush(\r\n\t\t\t\tquery.backgrounds.nodes.find(\r\n\t\t\t\t\tnode => node.relativePath === image\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t}\r\n\t}else{\r\n\t\tnodes = query.backgrounds.nodes;\r\n\t}\r\n\t\r\n\tconst imgs = nodes.map(\r\n\t\t(data, index)=>{\t\t\t\r\n\t\t\tconst backgroundStyle = {\r\n\t\t\t\tposition:\"absolute\", \r\n\t\t\t\tzIndex: -10,\r\n\t\t\t\twidth:\"100%\", \r\n\t\t\t\theight: \"100%\", \r\n\t\t\t\tmargin:0, \r\n\t\t\t\tpadding:\"none\", \r\n\t\t\t\tleft:0, top:0, \r\n\t\t\t\tbackgroundSize:\"cover\", \r\n\t\t\t\topacity: index ? 0 : 1, \r\n\t\t\t\ttransition: `opacity ${transition}s`\r\n\t\t\t};\r\n\r\n\t\t\tconst subStyle = {\r\n\t\t\t\topacity: index ? 0 : 1, \r\n\t\t\t\ttransition: `opacity ${transition}s`, \r\n\t\t\t\tpointerEvents: index ? \"none\" : \"auto\"\r\n\t\t\t}\r\n\r\n\t\t\tsubRefs[index] = React.createRef();\r\n\t\t\tbgRefs[index] = React.createRef();\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment key={index}>\r\n\t\t\t\t\t<div ref={bgRefs[index]}><Img fluid={data.childImageSharp.fluid} style={{...backgroundStyle, ...style}} {...imageProps}/></div>\r\n\t\t\t\t\t<div ref={subRefs[index]} style={subStyle}>{React.Children.toArray(children)[index]}</div>\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t);\r\n\t\t} \r\n\t);\r\n\t\r\n\tconst initEffect = () => {\r\n\t\tbgRefs.forEach((bgRef) => {\r\n\t\t\tbgWrappers.push(bgRef.current.firstElementChild);\t\t\t\r\n\t\t});\r\n\r\n\t\tsubRefs.forEach((subRef) =>{\r\n\t\t\tsubWrappers.push(subRef.current);\r\n\t\t})\r\n\t\t\r\n\t\tconst callback = function(index = 0){     \r\n\t\t\tconst length = bgWrappers.length;\r\n\t\t\t\r\n\t\t\tbgWrappers[index].style.opacity = 0;\r\n\t\t\tbgWrappers[(index + 1) % length].style.opacity = 1;\r\n\r\n\t\t\tsubWrappers[index].style.opacity = 0;\r\n\t\t\tsubWrappers[index].style.pointerEvents = \"none\";\r\n\t\t\t\r\n\t\t\tsubWrappers[(index + 1) % length].style.opacity = 1;\r\n\t\t\tsubWrappers[(index + 1) % length].style.pointerEvents = \"auto\";\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tsetTimeout(callback, duration * 1000, (index + 1) % length);\r\n\t\t}\r\n\r\n\t\tsetTimeout(callback, initDelay * 1000, 0);\t\r\n\t}\r\n\t \r\n\t// Runs once after DOM is loaded; effectively `componentDidMount`\t\r\n\tuseEffect(initEffect, []);\r\n\t\r\n\treturn <React.Fragment>{imgs}</React.Fragment>\t\r\n}\r\n\r\nBackgroundSlider.defaultProps = {\r\n\timages: null,\r\n\tduration: 5,\r\n\ttransition: 2,\r\n\tinitDelay: 5,\r\n}\r\n\r\nBackgroundSlider.propTypes = {\r\n\tquery: PropTypes.object.isRequired,\r\n\timages: PropTypes.arrayOf(PropTypes.string),\r\n\tduration: PropTypes.number,\r\n\ttransition: PropTypes.number,\r\n\tinitDelay: PropTypes.number,\r\n}\r\n\r\nexport default BackgroundSlider\r\n"],"names":["BackgroundSlider","images","duration","transition","initDelay","query","children","gatsbyImageProps","nodes","bgRefs","subRefs","bgWrappers","subWrappers","style","imageProps","safePush","data","push","length","image","backgrounds","find","node","relativePath","imgs","map","index","backgroundStyle","top","subStyle","React","createRef","childImageSharp","fluid","Children","toArray","initEffect","forEach","bgRef","current","firstElementChild","subRef","callback","opacity","pointerEvents","defaultProps","propTypes","PropTypes","object","isRequired","arrayOf","string","number"],"mappings":"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"}